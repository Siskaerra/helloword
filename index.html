<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://thekingearth.github.io/mywebsite.publish/styles/qs.css">
  <link rel="icon" type="image/png" href="../../img/favicon.png">
  <title>Bayyati</title>

  <script src="https://unpkg.com/feather-icons"></script>
</head>
<style>

</style>
<body>

  <p></p>

  <br>
</div>
</div>
<div class="player">
<h2 id="songTitle">Opening Track</h2>
<p>
Playlist | 08
</p>
<input type="range" id="progress" value="0" step="any" style="width: 100%;">

<div class="time">
<span id="current">0:00</span> / <span id="duration">0:00</span>
</div>
<div class="controls">
<button id="shuffle"><i data-feather="shuffle"></i></button>
<button id="prev"><i data-feather="skip-back"></i></button>
<button id="playPause"><i data-feather="play"></i></button>
<button id="next"><i data-feather="skip-forward"></i></button>
<button id="rewind"><i data-feather="rewind"></i></button>
<button id="showPlaylist"><i data-feather="disc"></i></button>
<button id="forward"><i data-feather="fast-forward"></i></button>
<button id="repeat"><i data-feather="repeat"></i></button>
</div>
<audio id="audio" src="https://airinerra.github.io/helloword/playlist/baleylot.mp3"></audio>
<ul id="playlistList" style="color: #fd0; display: none; list-style: none; padding: 0;"></ul>
</div>
<br><p></p>
<br><p></p>
<br><p></p>
<script>
const audio = document.getElementById("audio");
const playPauseBtn = document.getElementById("playPause");
const progress = document.getElementById("progress");
const currentTime = document.getElementById("current");
const durationTime = document.getElementById("duration");
const rewind = document.getElementById("rewind");
const forward = document.getElementById("forward");
const repeatBtn = document.getElementById("repeat");
const shuffleBtn = document.getElementById("shuffle");
const prevBtn = document.getElementById("prev");
const nextBtn = document.getElementById("next");
const playlist = [
"https://airinerra.github.io/helloword/playlist/baleylot.mp3",
"https://airinerra.github.io/helloword/askem/askim.mp3",
"https://siskaerra.github.io/helloword/marwah/Sonia.mp3"
];

const titles = [
"Opening Track",
"OpeningTrack",
"Ungkapan Hati"
];


let index = 0;
let isShuffle = false;
let isRepeat = false;

audio.onloadedmetadata = () => {
durationTime.textContent = formatTime(audio.duration);
progress.max = audio.duration;
};

audio.ontimeupdate = () => {
progress.value = audio.currentTime;
currentTime.textContent = formatTime(audio.currentTime);
};

progress.oninput = () => {
audio.currentTime = parseFloat(progress.value);
};

playPauseBtn.onclick = () => {
if (audio.paused) {
audio.play();
playPauseBtn.innerHTML = '<i data-feather="pause"></i>';
} else {
audio.pause();
playPauseBtn.innerHTML = '<i data-feather="play"></i>';
}
feather.replace();
};

rewind.onclick = () => {
audio.currentTime = Math.max(0, audio.currentTime - 10);
};

forward.onclick = () => {
audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
};

repeatBtn.onclick = () => {
isRepeat = !isRepeat;
repeatBtn.style.color = isRepeat ? "#d574de": "#fd0";
};

shuffleBtn.onclick = () => {
isShuffle = !isShuffle;
shuffleBtn.style.color = isShuffle ? "#d574de": "#fd0";
};

prevBtn.onclick = () => {
index = (index - 1 + playlist.length) % playlist.length;
loadSong();
};

nextBtn.onclick = () => {
index = isShuffle ? Math.floor(Math.random() * playlist.length): (index + 1) % playlist.length;
loadSong();
};

audio.onended = () => {
if (isRepeat) {
audio.currentTime = 0;
audio.play();
} else {
nextBtn.click();
}
};

function loadSong() {
audio.src = playlist[index];
document.getElementById("songTitle").textContent = titles[index];
audio.play();
playPauseBtn.innerHTML = '<i data-feather="pause"></i>';
feather.replace();
}


function formatTime(seconds) {
const mins = Math.floor(seconds / 60);
const secs = Math.floor(seconds % 60);
return `${mins}:${secs.toString().padStart(2, '0')}`;
}
progress.addEventListener('input', () => {
const percent = (progress.value / progress.max) * 100;
progress.style.setProperty('--progress', percent + '%');
});
audio.ontimeupdate = () => {
progress.value = audio.currentTime;
currentTime.textContent = formatTime(audio.currentTime);
const percent = (audio.currentTime / audio.duration) * 100;
progress.style.setProperty('--progress', percent + '%');
};

// list song
const showPlaylistBtn = document.getElementById("showPlaylist");
const playlistList = document.getElementById("playlistList");

showPlaylistBtn.onclick = () => {
if (playlistList.style.display === "none") {
playlistList.innerHTML = "";
titles.forEach((title, i) => {
const li = document.createElement("li");
li.textContent = title;
li.style.cursor = "pointer";
li.onclick = () => {
index = i;
loadSong();
};
playlistList.appendChild(li);
});
playlistList.style.display = "block";
showPlaylistBtn.innerHTML = '<i data-feather="disc"></i>';
feather.replace();
} else {
playlistList.style.display = "none";
showPlaylistBtn.innerHTML = '<i data-feather="disc"></i>';
feather.replace();
}
};
</script>
<script>
feather.replace();
</script>
</body>
</html>
